# TMRVC Research Studio â€” GUI Design

Kojiro Tanaka â€” GUI design
Created: 2026-02-16 (Asia/Tokyo)

> **Goal:** TMRVC ã®ç ”ç©¶ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ (ãƒ‡ãƒ¼ã‚¿æº–å‚™â†’Teacherå­¦ç¿’â†’è’¸ç•™â†’è©•ä¾¡â†’Speakerç™»éŒ²â†’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ VCâ†’ONNXã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ) ã‚’
> çµ±åˆã™ã‚‹ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ— GUI ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚DAW ãªã—ã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  VC ãƒ†ã‚¹ãƒˆãŒå¯èƒ½ãªã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ãƒ„ãƒ¼ãƒ«ã€‚

---

## 1. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯é¸å®š

### 1.1 é¸å®š: PySide6 (Qt for Python)

| è¦ä»¶ | PySide6 ã®å¼·ã¿ |
|---|---|
| Python ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¨ã®çµ±åˆ | åŒä¸€ãƒ—ãƒ­ã‚»ã‚¹ã§ `import tmrvc_train` ç­‰ãŒå¯èƒ½ã€‚IPC ä¸è¦ |
| ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚ªãƒ¼ãƒ‡ã‚£ã‚ª | sounddevice (PortAudio) ã§ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é§†å‹•ã€‚GIL-free C ãƒ¬ãƒ™ãƒ«å‡¦ç† |
| ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ­ãƒƒãƒˆ | pyqtgraph ã§ä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·æç”» (matplotlib ã® 10-100x é«˜é€Ÿ) |
| ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¸ãƒ§ãƒ– | QThread + Signal/Slot ã§ GUI ã¨å®‰å…¨ã«é€šä¿¡ |
| ãƒã‚¤ãƒ†ã‚£ãƒ– UI | ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãƒã‚¤ãƒ†ã‚£ãƒ–ã®å¤–è¦³ã€‚Windows/macOS/Linux å¯¾å¿œ |
| ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ | LGPL (PySide6)ã€‚å•†ç”¨åˆ©ç”¨å¯èƒ½ |

### 1.2 å´ä¸‹ã—ãŸå€™è£œ

| å€™è£œ | å´ä¸‹ç†ç”± |
|---|---|
| **Gradio** | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ä¸å¯ã€‚ãƒãƒƒãƒå‡¦ç†ã®ã¿ |
| **Electron** | Node.js â†” Python IPC ãŒè¤‡é›‘ã€‚ãƒã‚¤ãƒŠãƒªã‚µã‚¤ã‚ºå·¨å¤§ (200MB+) |
| **Tauri** | Rust + JS + Python ã® 3 è¨€èªä½“åˆ¶ã€‚ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚³ã‚¹ãƒˆé«˜ |
| **Dear ImGui** | Python ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã®æˆç†Ÿåº¦ä¸è¶³ã€‚ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚»ãƒƒãƒˆãŒé™å®šçš„ |

### 1.3 ä¸»è¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

| ãƒ©ã‚¤ãƒ–ãƒ©ãƒª | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|---|---|---|
| PySide6 | >= 6.6 | GUI ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| pyqtgraph | >= 0.13 | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ­ãƒƒãƒˆ (Loss ã‚«ãƒ¼ãƒ–, æ³¢å½¢, ãƒ¡ãƒ¼ã‚¿ãƒ¼) |
| sounddevice | >= 0.4 | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªå…¥å‡ºåŠ› (PortAudio ãƒ©ãƒƒãƒ‘ãƒ¼) |
| onnxruntime | >= 1.17 | ONNX ãƒ¢ãƒ‡ãƒ«æ¨è«– (CPU EP) |
| numpy | >= 1.26 | ãƒ†ãƒ³ã‚½ãƒ«æ“ä½œ |

---

## 2. Monorepo é…ç½®

`tmrvc-gui/` ã‚’ workspace member ã¨ã—ã¦è¿½åŠ :

```
TMRVC/
â”œâ”€â”€ docs/design/
â”‚   â””â”€â”€ gui-design.md          # æœ¬è³‡æ–™
â”œâ”€â”€ tmrvc-core/                # å…±æœ‰å®šæ•°ãƒ»mel è¨ˆç®—
â”œâ”€â”€ tmrvc-data/                # ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãƒ»å‰å‡¦ç†
â”œâ”€â”€ tmrvc-train/               # ãƒ¢ãƒ‡ãƒ«å®šç¾©ãƒ»å­¦ç¿’
â”œâ”€â”€ tmrvc-export/              # ONNX ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
â”œâ”€â”€ tmrvc-engine/              # C++ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³
â”œâ”€â”€ tmrvc-plugin/              # JUCE VST3 ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
â”œâ”€â”€ tmrvc-gui/                 # â˜… æ–°è¦: Research Studio GUI
â”‚   â”œâ”€â”€ pyproject.toml
â”‚   â””â”€â”€ src/tmrvc_gui/
â””â”€â”€ pyproject.toml             # uv workspace root (member è¿½åŠ )
```

### ä¾å­˜ã‚°ãƒ©ãƒ• (Python å´)

```
tmrvc-core â—€â”€â”€â”€ tmrvc-data â—€â”€â”€â”€ tmrvc-train
     â–²               â–²               â”‚
     â”‚               â”‚               â–¼
     â””â”€â”€â”€â”€â”€â”€â”€â”€ tmrvc-export â—€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–²
                     â”‚
               tmrvc-gui â”€â”€â”€â”€â”€â”€â–¶ tmrvc-data
                     â”‚â”€â”€â”€â”€â”€â”€â–¶ tmrvc-train
                     â””â”€â”€â”€â”€â”€â”€â–¶ tmrvc-export
```

`tmrvc-gui` ã¯å…¨ Python ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ä¾å­˜ã—ã€çµ±åˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ã€‚

---

## 3. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ§‹é€ 

### 3.1 ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TMRVC Research Studio                          [â”€][â–¡][Ã—]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚                                               â”‚
â”‚  [ğŸ“] Data   â”‚            Main Content Area              â”‚
â”‚  [ğŸ“] Train  â”‚         (QStackedWidget)                  â”‚
â”‚  [âš—ï¸] Distillâ”‚                                           â”‚
â”‚  [ğŸ“Š] Eval   â”‚   é¸æŠã•ã‚ŒãŸã‚¿ãƒ–ã«å¯¾å¿œã™ã‚‹                â”‚
â”‚  [ğŸ¤] Speakerâ”‚   ãƒšãƒ¼ã‚¸ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚’è¡¨ç¤º                â”‚
â”‚  [ğŸ”Š] Demo   â”‚                                           â”‚
â”‚  [ğŸ“¦] Export â”‚                                           â”‚
â”‚          â”‚                                               â”‚
â”‚          â”‚                                               â”‚
â”‚ Sidebar  â”‚                                               â”‚
â”‚ (QListW) â”‚                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Status: Ready â”‚ GPU: N/A â”‚ Model: (none) â”‚ Latency: --  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼**: QListWidgetã€7 ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
- **ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢**: QStackedWidgetã€ã‚¿ãƒ–ã«å¯¾å¿œã™ã‚‹ 7 ãƒšãƒ¼ã‚¸
- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼**: QStatusBarã€ç¾åœ¨ã®çŠ¶æ…‹ãƒ»ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨çŠ¶æ³

### 3.2 ç”»é¢é·ç§»

ã‚µã‚¤ãƒ‰ãƒãƒ¼é …ç›®ã‚¯ãƒªãƒƒã‚¯ â†’ QStackedWidget.setCurrentIndex() ã§ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆã€‚
å„ãƒšãƒ¼ã‚¸ã¯ç‹¬ç«‹ã—ãŸã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã§ã€é…å»¶åˆæœŸåŒ– (åˆå›è¡¨ç¤ºæ™‚ã«ãƒªã‚½ãƒ¼ã‚¹ãƒ­ãƒ¼ãƒ‰)ã€‚

---

## 4. ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç”»é¢

### 4.1 Data Prep (ãƒ‡ãƒ¼ã‚¿æº–å‚™)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Data Preparation                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Corpus Manager â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ [+Add]  [Scan]                          â”‚    â”‚
â”‚  â”‚                                          â”‚    â”‚
â”‚  â”‚ â˜‘ VCTK     109 spk  44h   /data/vctk   â”‚    â”‚
â”‚  â”‚ â˜‘ JVS      100 spk  30h   /data/jvs    â”‚    â”‚
â”‚  â”‚ â˜ LibriTTS 2456 spk 585h  (not found)  â”‚    â”‚
â”‚  â”‚ â˜ Emilia   ---       ---  (not found)   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Preprocessing Pipeline â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Steps: â˜‘ Resample  â˜‘ Normalize          â”‚    â”‚
â”‚  â”‚        â˜‘ VAD Trim  â˜‘ Segment            â”‚    â”‚
â”‚  â”‚        â˜‘ Features (F0, ContentVec, Spk) â”‚    â”‚
â”‚  â”‚                                          â”‚    â”‚
â”‚  â”‚ Workers: [4 â–¾]   [â–¶ Run Pipeline]       â”‚    â”‚
â”‚  â”‚                                          â”‚    â”‚
â”‚  â”‚ Progress: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  67% (1234/1842) â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Log â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ [14:32:01] Processing VCTK/p225/001...  â”‚    â”‚
â”‚  â”‚ [14:32:02] Extracted F0: 240 frames     â”‚    â”‚
â”‚  â”‚ ...                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ©Ÿèƒ½:**
- ã‚³ãƒ¼ãƒ‘ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®è¿½åŠ ãƒ»ã‚¹ã‚­ãƒ£ãƒ³ãƒ»çµ±è¨ˆè¡¨ç¤º
- å‰å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®è¨­å®šãƒ»å®Ÿè¡Œ (tmrvc-data å‘¼ã³å‡ºã—)
- ãƒãƒ«ãƒãƒ¯ãƒ¼ã‚«ãƒ¼ä¸¦åˆ—å‡¦ç†ã€é€²æ—ãƒãƒ¼ã€ãƒ­ã‚°è¡¨ç¤º

### 4.2 Teacher Training (Teacher å­¦ç¿’)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Teacher Training                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Phase Config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Phase: [Phase 0: Validation â–¾]          â”‚    â”‚
â”‚  â”‚ Dataset: â˜‘ VCTK  â˜‘ JVS                 â”‚    â”‚
â”‚  â”‚ Batch: [16]  LR: [1e-4]  Steps: [50K]  â”‚    â”‚
â”‚  â”‚                                          â”‚    â”‚
â”‚  â”‚ Execution: â—‹ Local  â— SSH Remote        â”‚    â”‚
â”‚  â”‚ Host: [gpu-server.example.com]          â”‚    â”‚
â”‚  â”‚                                          â”‚    â”‚
â”‚  â”‚ [â–¶ Start Training]  [â¸ Pause]  [â¹ Stop]â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Metrics (Real-time) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Loss â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   SECS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚    â”‚
â”‚  â”‚  â”‚\                   â”‚      ___----     â”‚    â”‚
â”‚  â”‚  â”‚ \___               â”‚  ---            â”‚    â”‚
â”‚  â”‚  â”‚     \___           â”‚ /                â”‚    â”‚
â”‚  â”‚  â”‚         ----___    â”‚/                 â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€ step â”€â”€â”€â”€â”€â”€   â””â”€â”€â”€â”€ step â”€â”€â”€â”€â”€â”€  â”‚    â”‚
â”‚  â”‚                                          â”‚    â”‚
â”‚  â”‚  UTMOS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   LR Schedule â”€â”€â”€â”€â”€  â”‚    â”‚
â”‚  â”‚  â”‚       ___----      â”‚ ----             â”‚    â”‚
â”‚  â”‚  â”‚   ---              â”‚      \           â”‚    â”‚
â”‚  â”‚  â”‚  /                 â”‚       \____      â”‚    â”‚
â”‚  â”‚  â”‚ /                  â”‚            \     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€ step â”€â”€â”€â”€â”€â”€   â””â”€â”€â”€â”€ step â”€â”€â”€â”€â”€â”€  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Log â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ [14:32:01] Step 1000 | loss=0.342 ...   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ©Ÿèƒ½:**
- Phase 0-3 ã®è¨­å®š (training-plan.md æº–æ‹ )
- ãƒ­ãƒ¼ã‚«ãƒ« / SSH ãƒªãƒ¢ãƒ¼ãƒˆå®Ÿè¡Œã®åˆ‡ã‚Šæ›¿ãˆ
- Loss, SECS, UTMOS, LR ã® 4 ãƒ—ãƒ­ãƒƒãƒˆã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æç”» (pyqtgraph)
- å­¦ç¿’ã®é–‹å§‹ãƒ»ä¸€æ™‚åœæ­¢ãƒ»åœæ­¢
- Checkpoint ä¸€è¦§ãƒ»é¸æŠ

### 4.3 Distillation (è’¸ç•™)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Distillation                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Configuration â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Teacher ckpt: [phase1_step50k.pt  â–¾]   â”‚     â”‚
â”‚  â”‚ Phase: â—‹ A: ODE Trajectory  â— B: DMD   â”‚     â”‚
â”‚  â”‚ Student arch: [CausalCNN-7.7M â–¾]       â”‚     â”‚
â”‚  â”‚ Batch: [32]   Steps: [20K]              â”‚     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚ [â–¶ Start Distillation]                  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Teacher vs Student Comparison â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚  Distill Loss â”€â”€â”€â”€   Feature MSE â”€â”€â”€â”€â”€  â”‚     â”‚
â”‚  â”‚  (ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ­ãƒƒãƒˆ)                 â”‚     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚  â”€â”€ A/B Listening â”€â”€                    â”‚     â”‚
â”‚  â”‚  Source:  [â–¶ Play]                      â”‚     â”‚
â”‚  â”‚  Teacher: [â–¶ Play]                      â”‚     â”‚
â”‚  â”‚  Student: [â–¶ Play]                      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ©Ÿèƒ½:**
- Teacher checkpoint é¸æŠ
- ODE trajectory â†’ DMD ã® 2 ãƒ•ã‚§ãƒ¼ã‚ºè’¸ç•™å®Ÿè¡Œ
- Teacher / Student å‡ºåŠ›ã® A/B è©¦è´æ¯”è¼ƒ
- è’¸ç•™ Loss ã¨ Feature MSE ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ­ãƒƒãƒˆ

### 4.4 Evaluation (è©•ä¾¡)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Evaluation                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Model Selection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Model A: [student_step20k.pt â–¾]        â”‚     â”‚
â”‚  â”‚ Model B: [student_step15k.pt â–¾]        â”‚     â”‚
â”‚  â”‚ Eval set: [VCTK test â–¾]                â”‚     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚ [â–¶ Run Evaluation]                      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Objective Metrics â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Metric       Model A    Model B  Targetâ”‚     â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚     â”‚
â”‚  â”‚  SECS         0.891      0.876   â‰¥0.88 â”‚     â”‚
â”‚  â”‚  UTMOS        3.92       3.81    â‰¥3.8  â”‚     â”‚
â”‚  â”‚  MCD          5.12       5.34     â†“    â”‚     â”‚
â”‚  â”‚  F0 RMSE      12.3       13.1     â†“    â”‚     â”‚
â”‚  â”‚  Latency(ms)  4.2        4.1      â‰¤10  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ A/B Blind Listening Test â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Sample 3/20:                            â”‚     â”‚
â”‚  â”‚   Source: [â–¶]   A: [â–¶]   B: [â–¶]        â”‚     â”‚
â”‚  â”‚   Which is better?  [A] [Same] [B]      â”‚     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚ Results: A wins: 8  Same: 4  B wins: 3  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ©Ÿèƒ½:**
- ãƒ¢ãƒ‡ãƒ« A/B é¸æŠã«ã‚ˆã‚‹æ¯”è¼ƒè©•ä¾¡
- å®¢è¦³æŒ‡æ¨™ãƒ†ãƒ¼ãƒ–ãƒ« (SECS, UTMOS, MCD, F0 RMSE, Latency)
- ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰ A/B è©¦è´ãƒ†ã‚¹ãƒˆ (é †åºãƒ©ãƒ³ãƒ€ãƒ åŒ–)
- è©•ä¾¡ç›®æ¨™: SECS >= 0.88, UTMOS >= 3.8 (training-plan.md æº–æ‹ )

### 4.5 Speaker Enrollment (è©±è€…ç™»éŒ²)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Speaker Enrollment                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Reference Audio â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚     â”‚
â”‚  â”‚   â”‚                                 â”‚   â”‚     â”‚
â”‚  â”‚   â”‚    Drag & Drop audio files      â”‚   â”‚     â”‚
â”‚  â”‚   â”‚    (.wav, .flac, .mp3)          â”‚   â”‚     â”‚
â”‚  â”‚   â”‚    3-20 utterances recommended  â”‚   â”‚     â”‚
â”‚  â”‚   â”‚                                 â”‚   â”‚     â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚   Files: speaker_ref_01.wav (3.2s)      â”‚     â”‚
â”‚  â”‚          speaker_ref_02.wav (4.1s)      â”‚     â”‚
â”‚  â”‚          speaker_ref_03.wav (2.8s)      â”‚     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚   Speaker name: [My Speaker]            â”‚     â”‚
â”‚  â”‚   [â–¶ Generate .tmrvc_speaker]           â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Quick Test â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Source: [â–¶ Record 5s]  or [Browse...]   â”‚     â”‚
â”‚  â”‚ Result: [â–¶ Play converted]              â”‚     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚ Waveform: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚     â”‚
â”‚  â”‚           â”‚ ~~\/\/~~\/~~\/\/~~     â”‚    â”‚     â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ©Ÿèƒ½:**
- å‚ç…§éŸ³å£°ã®ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ— (3-20 ç™ºè©±æ¨å¥¨)
- ECAPA-TDNN ã§ spk_embed (192-dim) + LoRA delta ã‚’è¨ˆç®—
- `.tmrvc_speaker` ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ (onnx-contract.md Â§6 ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæº–æ‹ )
- Quick Test: çŸ­ã„éŸ³å£°ã§ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ VC å®Ÿè¡Œãƒ»è©¦è´

### 4.6 Realtime Demo (ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  VC ãƒ‡ãƒ¢)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Realtime Voice Conversion Demo                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Audio Devices â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Input:  [Microphone (Realtek) â–¾]       â”‚     â”‚
â”‚  â”‚ Output: [Speakers (Realtek) â–¾]         â”‚     â”‚
â”‚  â”‚ Buffer: [512 â–¾] samples               â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Model & Speaker â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ ONNX dir: [/models/student_v1/ â–¾]      â”‚     â”‚
â”‚  â”‚ Speaker:  [My Speaker.tmrvc_speaker â–¾]  â”‚     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚    [â— Start VC]     [â¹ Stop]            â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Monitor â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚  Input Level    Output Level             â”‚     â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘              â”‚     â”‚
â”‚  â”‚  -12.3 dB       -14.1 dB               â”‚     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚  Inference: 3.8ms / 10ms hop            â”‚     â”‚
â”‚  â”‚  Latency:   ~27ms (estimated)           â”‚     â”‚
â”‚  â”‚  Buffer:    OK (no underruns)           â”‚     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚  Dry/Wet: [â”€â”€â”€â”€â”€â”€â—â”€â”€] 80%              â”‚     â”‚
â”‚  â”‚  Output Gain: [â”€â”€â”€â”€â—â”€â”€â”€â”€] 0 dB          â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Waveform â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Input:  ~~\/\/~~\/~~\/\/~~\/~~        â”‚     â”‚
â”‚  â”‚  Output: ~~\/~~\/\/~~\/\/~~\/~~        â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ©Ÿèƒ½:**
- ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªãƒ‡ãƒã‚¤ã‚¹é¸æŠ (sounddevice ãƒ‡ãƒã‚¤ã‚¹åˆ—æŒ™)
- ONNX ãƒ¢ãƒ‡ãƒ« & .tmrvc_speaker ãƒ•ã‚¡ã‚¤ãƒ«ã®é¸æŠ
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  VC ã®é–‹å§‹ãƒ»åœæ­¢
- å…¥å‡ºåŠ›ãƒ¬ãƒ™ãƒ«ãƒ¡ãƒ¼ã‚¿ãƒ¼ã€æ¨è«–æ™‚é–“ãƒ¢ãƒ‹ã‚¿ã€ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·è¡¨ç¤º
- Dry/Wet ãƒŸãƒƒã‚¯ã‚¹ã€å‡ºåŠ›ã‚²ã‚¤ãƒ³èª¿æ•´
- å…¥å‡ºåŠ›æ³¢å½¢ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º

### 4.7 ONNX Export (ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ONNX Export & Verification                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Export Configuration â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Checkpoint: [student_step20k.pt â–¾]     â”‚     â”‚
â”‚  â”‚ Output dir: [/export/v1/]              â”‚     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚ â˜‘ content_encoder  â˜‘ converter          â”‚     â”‚
â”‚  â”‚ â˜‘ ir_estimator     â˜‘ vocoder            â”‚     â”‚
â”‚  â”‚ â˜‘ speaker_encoder                       â”‚     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚ [â–¶ Export FP32]  [â–¶ Quantize INT8]      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Parity Verification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Model             max_abs  mean_abs   â”‚     â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚     â”‚
â”‚  â”‚  content_encoder   2.1e-6   3.4e-7 âœ“  â”‚     â”‚
â”‚  â”‚  converter         8.7e-6   1.2e-6 âœ“  â”‚     â”‚
â”‚  â”‚  vocoder           5.3e-6   8.1e-7 âœ“  â”‚     â”‚
â”‚  â”‚  ir_estimator      1.1e-6   2.0e-7 âœ“  â”‚     â”‚
â”‚  â”‚                                         â”‚     â”‚
â”‚  â”‚  Target: max < 1e-5, mean < 1e-6       â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€ Benchmark â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Model             FP32     INT8        â”‚     â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚     â”‚
â”‚  â”‚  content_encoder   0.31ms   0.22ms     â”‚     â”‚
â”‚  â”‚  converter         2.10ms   1.45ms     â”‚     â”‚
â”‚  â”‚  vocoder           0.98ms   0.71ms     â”‚     â”‚
â”‚  â”‚  ir_estimator      0.52ms   0.38ms     â”‚     â”‚
â”‚  â”‚  Total per-frame   3.39ms   2.38ms     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ©Ÿèƒ½:**
- PyTorch checkpoint â†’ ONNX ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ (5 ãƒ¢ãƒ‡ãƒ«å€‹åˆ¥é¸æŠ)
- FP32 ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ + INT8 å‹•çš„é‡å­åŒ– (tmrvc-export å‘¼ã³å‡ºã—)
- Python â†” ONNX Runtime æ•°å€¤ãƒ‘ãƒªãƒ†ã‚£æ¤œè¨¼ãƒ†ãƒ¼ãƒ–ãƒ«
- æ¨è«–ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœè¡¨ç¤º

---

## 5. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªè¨­è¨ˆ: Python ç‰ˆ StreamingEngine

### 5.1 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

C++ ã‚¨ãƒ³ã‚¸ãƒ³ (cpp-engine-design.md) ã¨åŒæ–¹å¼ã‚’ Python ã§å®Ÿè£…ã™ã‚‹ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Realtime Demo Page                                       â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  sounddevice Input Callback (PortAudio C thread)    â”‚ â”‚
â”‚  â”‚  48kHz â†’ Downsample â†’ Input Ring Buffer (write)     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚ (ring buffer, lock-free)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Audio Processing Thread (QThread)                   â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚  Loop every ~5ms:                                    â”‚ â”‚
â”‚  â”‚    while input_ring.available() >= hop_length:       â”‚ â”‚
â”‚  â”‚      frame = input_ring.read(hop_length)             â”‚ â”‚
â”‚  â”‚      mel = causal_stft_mel(frame)                    â”‚ â”‚
â”‚  â”‚      f0 = extract_f0(frame)                          â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚      content = content_encoder.run(mel, f0, state)   â”‚ â”‚
â”‚  â”‚      if frame_count % 10 == 0:                       â”‚ â”‚
â”‚  â”‚        ir = ir_estimator.run(mel_chunk, state)       â”‚ â”‚
â”‚  â”‚      features = converter.run(content, spk, ir, st)  â”‚ â”‚
â”‚  â”‚      mag, phase = vocoder.run(features, state)       â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚      audio = istft_ola(mag, phase)                   â”‚ â”‚
â”‚  â”‚      output_ring.write(audio)                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚ (ring buffer, lock-free)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  sounddevice Output Callback (PortAudio C thread)   â”‚ â”‚
â”‚  â”‚  Output Ring Buffer (read) â†’ Upsample â†’ 48kHz       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ONNX æ¨è«–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ (onnx-contract.md æº–æ‹ )

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å€¤ | å‡ºå…¸ |
|---|---|---|
| sample_rate | 24000 Hz | constants.yaml |
| hop_length | 240 samples (10ms) | constants.yaml |
| n_fft | 1024 | constants.yaml |
| window_length | 960 samples (40ms) | constants.yaml |
| n_mels | 80 | constants.yaml |
| Causal window | å³ç«¯ = ç¾åœ¨ãƒ•ãƒ¬ãƒ¼ãƒ  | streaming-design.md Â§1 |

### 5.3 State Tensor Ping-Pong

C++ ã‚¨ãƒ³ã‚¸ãƒ³ (cpp-engine-design.md) ã¨åŒæ–¹å¼ã® Ping-Pong double buffering:

```python
# State tensor ã‚’ 2 é¢æŒã¡ã€ãƒ•ãƒ¬ãƒ¼ãƒ ã”ã¨ã« swap
state_a = np.zeros((1, dim, depth), dtype=np.float32)
state_b = np.zeros((1, dim, depth), dtype=np.float32)
use_a = True

# Per-frame:
state_in = state_a if use_a else state_b
state_out = state_b if use_a else state_a
# ONNX run: state_in â†’ model â†’ state_out
use_a = not use_a
```

å„ãƒ¢ãƒ‡ãƒ«ã® State tensor å½¢çŠ¶ (onnx-contract.md Â§3 æº–æ‹ ):

| Model | State Shape | Size (bytes) |
|---|---|---|
| content_encoder | `[1, 256, 28]` | 28,672 |
| ir_estimator | `[1, 128, 6]` | 3,072 |
| converter | `[1, 384, 24]` | 36,864 |
| vocoder | `[1, 513, 14]` | 28,728 |

### 5.4 æ¨å®šãƒ¬ã‚¤ãƒ†ãƒ³ã‚· (Python ç‰ˆ)

```
sounddevice input buffer:  512 samples / 48000 Hz â‰ˆ 10.7ms
Downsample (polyphase):    ~0.1ms
Algorithmic (hop wait):    10ms (worst case, avg 5ms)
ONNX inference (4 models): ~4-6ms (CPU, Python overhead å«ã‚€)
Upsample (polyphase):      ~0.1ms
sounddevice output buffer: 512 samples / 48000 Hz â‰ˆ 10.7ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total estimated:           ~26-38ms (50ms ä»¥ä¸‹é”æˆ)
```

Python ç‰ˆã¯ C++ ç‰ˆ (~25ms) ã‚ˆã‚Šè‹¥å¹²é…ã„ãŒã€ç ”ç©¶ç”¨é€”ã«ã¯ååˆ†ã€‚

### 5.5 Ring Buffer è¨­è¨ˆ

```python
class RingBuffer:
    """Lock-free single-producer single-consumer ring buffer."""

    def __init__(self, capacity: int):
        self._buf = np.zeros(capacity, dtype=np.float32)
        self._capacity = capacity
        self._write_pos = 0  # only written by producer
        self._read_pos = 0   # only written by consumer

    def write(self, data: np.ndarray) -> int: ...
    def read(self, count: int) -> np.ndarray | None: ...
    def available(self) -> int: ...
```

å®¹é‡: å…¥åŠ›/å‡ºåŠ›ãã‚Œãã‚Œ 4096 samples (C++ ç‰ˆ 2048 ã®å€ã€‚Python ã®å‡¦ç†æºã‚‰ãã‚’å¸å)ã€‚

---

## 6. ã‚¹ãƒ¬ãƒƒãƒ‰ãƒ¢ãƒ‡ãƒ«

```
Thread 1: GUI Event Loop (Qt main thread)
  â”œâ”€â”€ ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆæç”»ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œ
  â”œâ”€â”€ Signal/Slot ã§ãƒ¯ãƒ¼ã‚«ãƒ¼ã¨é€šä¿¡
  â””â”€â”€ pyqtgraph ãƒ—ãƒ­ãƒƒãƒˆæ›´æ–° (timer-driven, ~30fps)

Thread 2: sounddevice Callback (PortAudio, C level)
  â”œâ”€â”€ Input callback: ãƒã‚¤ã‚¯ â†’ Input Ring Buffer
  â””â”€â”€ Output callback: Output Ring Buffer â†’ ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼
  â€» GIL ã‚’å–å¾—ã—ãªã„ã€‚numpy array ã¸ã®ç›´æ¥æ›¸ãè¾¼ã¿

Thread 3: Audio Processing (QThread)
  â”œâ”€â”€ Input Ring Buffer â†’ ONNX æ¨è«– â†’ Output Ring Buffer
  â”œâ”€â”€ æ¨è«–æ™‚é–“ãƒ»ãƒ¬ãƒ™ãƒ«ã‚’ Signal ã§ GUI ã«é€šçŸ¥
  â””â”€â”€ Dry/Wet mix å‡¦ç†

Thread 4: Background Jobs (QThread pool)
  â”œâ”€â”€ å­¦ç¿’ã‚¸ãƒ§ãƒ– (train_worker.py)
  â”œâ”€â”€ ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç† (data_worker.py)
  â”œâ”€â”€ ONNX ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ (export_worker.py)
  â””â”€â”€ è©•ä¾¡ (eval_worker.py)
  â€» åŒæ™‚ã« 1 ã‚¸ãƒ§ãƒ–ã®ã¿å®Ÿè¡Œ (GPU/CPU ãƒªã‚½ãƒ¼ã‚¹ç«¶åˆå›é¿)
```

### ã‚¹ãƒ¬ãƒƒãƒ‰é–“é€šä¿¡

| From | To | æ‰‹æ®µ | ãƒ‡ãƒ¼ã‚¿ |
|---|---|---|---|
| sounddevice â†’ Audio Thread | Thread 2 â†’ 3 | Ring Buffer (lock-free) | PCM samples |
| Audio Thread â†’ sounddevice | Thread 3 â†’ 2 | Ring Buffer (lock-free) | PCM samples |
| Audio Thread â†’ GUI | Thread 3 â†’ 1 | Qt Signal/Slot (queued) | æ¨è«–æ™‚é–“, ãƒ¬ãƒ™ãƒ« |
| Background Job â†’ GUI | Thread 4 â†’ 1 | Qt Signal/Slot (queued) | progress, log, metric |
| GUI â†’ Audio Thread | Thread 1 â†’ 3 | atomic flag / queue | start/stop, params |
| GUI â†’ Background Job | Thread 1 â†’ 4 | QThread.start() | job config |

---

## 7. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ

### 7.1 BaseWorker (workers/base_worker.py)

å…¨ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¸ãƒ§ãƒ–ã®åŸºåº•ã‚¯ãƒ©ã‚¹ã€‚

```python
class BaseWorker(QThread):
    progress = Signal(int, int)       # current, total
    log_message = Signal(str)         # log line
    metric = Signal(str, float, int)  # name, value, step
    finished = Signal(bool, str)      # success, message
    error = Signal(str)               # error message

    def run(self):
        """Override in subclass."""
        raise NotImplementedError
```

### 7.2 ProjectState (models/project_state.py)

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‘ã‚¹ç®¡ç†ãƒ»checkpoint ç™ºè¦‹ãƒ»ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯ã€‚

```python
class ProjectState:
    project_root: Path
    data_dir: Path
    checkpoints_dir: Path
    export_dir: Path
    speakers_dir: Path

    def find_checkpoints(self, pattern: str) -> list[Path]: ...
    def find_speakers(self) -> list[Path]: ...
    def find_onnx_models(self) -> list[Path]: ...
    def check_prerequisites(self, task: str) -> list[str]: ...
```

### 7.3 MetricPlot (widgets/metric_plot.py)

pyqtgraph ãƒ™ãƒ¼ã‚¹ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ­ãƒƒãƒˆã€‚

```python
class MetricPlot(pg.PlotWidget):
    def __init__(self, title: str, x_label: str, y_label: str,
                 max_points: int = 10000):
        ...

    def add_point(self, x: float, y: float, series: str = "default"): ...
    def clear_series(self, series: str = "default"): ...
```

max_points ã‚’è¶…ãˆãŸã‚‰é–“å¼•ã (LTTB ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ) ã§ãƒ¡ãƒ¢ãƒªã¨æç”»é€Ÿåº¦ã‚’ç¶­æŒã€‚

### 7.4 AudioEngine (workers/audio_engine.py)

Python ç‰ˆã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚° VC ã‚¨ãƒ³ã‚¸ãƒ³ã€‚

```python
class AudioEngine(QThread):
    level_updated = Signal(float, float)    # input_db, output_db
    timing_updated = Signal(float)          # inference_ms
    buffer_status = Signal(bool)            # underrun occurred

    def __init__(self, onnx_dir: Path, speaker_path: Path): ...
    def start_stream(self, input_device: int, output_device: int,
                     buffer_size: int = 512): ...
    def stop_stream(self): ...
    def set_dry_wet(self, ratio: float): ...
    def set_output_gain(self, gain_db: float): ...
```

---

## 8. Cloud GPU çµ±åˆ

SSH çµŒç”±ã§å­¦ç¿’ã‚¸ãƒ§ãƒ–ã‚’èµ·å‹•ãƒ»ç›£è¦–ã™ã‚‹æ©Ÿèƒ½ã€‚

### 8.1 SSH ã‚¸ãƒ§ãƒ–ãƒ•ãƒ­ãƒ¼

```
1. GUI: SSH æ¥ç¶šæƒ…å ±ã‚’è¨­å®š (host, user, key, remote_dir)
2. GUI â†’ SSH: rsync ã§ã‚³ãƒ¼ãƒ‰ã¨è¨­å®šã‚’åŒæœŸ
3. GUI â†’ SSH: tmux/screen ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å­¦ç¿’ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’èµ·å‹•
4. GUI â† SSH: ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ tail -f ã§ç›£è¦– (paramiko channel)
5. GUI â† SSH: metric JSON ã‚’å®šæœŸçš„ã« rsync
6. GUI â† SSH: checkpoint ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠçš„ã« rsync
7. GUI: ãƒ­ãƒ¼ã‚«ãƒ«ã§ metric ãƒ—ãƒ­ãƒƒãƒˆã‚’æ›´æ–°
```

### 8.2 å®Ÿè£…

- `paramiko` ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ SSH æ¥ç¶š
- ãƒªãƒ¢ãƒ¼ãƒˆãƒ­ã‚°ã¯ polling (5 ç§’é–“éš”) ã§ãƒ•ã‚§ãƒƒãƒ
- Checkpoint sync ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã§ãƒˆãƒªã‚¬ãƒ¼ (è‡ªå‹•åŒæœŸã¯å¸¯åŸŸæ¶ˆè²»)

---

## 9. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹é€ 

```
tmrvc-gui/
â”œâ”€â”€ pyproject.toml
â””â”€â”€ src/tmrvc_gui/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ __main__.py              # ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ (uv run tmrvc-gui)
    â”œâ”€â”€ app.py                   # QApplication åˆæœŸåŒ–ã€ã‚¹ã‚¿ã‚¤ãƒ«é©ç”¨
    â”œâ”€â”€ main_window.py           # MainWindow: ã‚µã‚¤ãƒ‰ãƒãƒ¼ + StackedWidget + StatusBar
    â”œâ”€â”€ pages/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ data_prep.py         # Data Preparation ãƒšãƒ¼ã‚¸
    â”‚   â”œâ”€â”€ teacher_train.py     # Teacher Training ãƒšãƒ¼ã‚¸
    â”‚   â”œâ”€â”€ distillation.py      # Distillation ãƒšãƒ¼ã‚¸
    â”‚   â”œâ”€â”€ evaluation.py        # Evaluation ãƒšãƒ¼ã‚¸
    â”‚   â”œâ”€â”€ enrollment.py        # Speaker Enrollment ãƒšãƒ¼ã‚¸
    â”‚   â”œâ”€â”€ realtime_demo.py     # Realtime Demo ãƒšãƒ¼ã‚¸
    â”‚   â””â”€â”€ onnx_export.py       # ONNX Export ãƒšãƒ¼ã‚¸
    â”œâ”€â”€ workers/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ base_worker.py       # BaseWorker (QThread, Signal/Slot)
    â”‚   â”œâ”€â”€ train_worker.py      # Teacher/Student å­¦ç¿’ã‚¸ãƒ§ãƒ–
    â”‚   â”œâ”€â”€ data_worker.py       # ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†ã‚¸ãƒ§ãƒ–
    â”‚   â”œâ”€â”€ export_worker.py     # ONNX ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚¸ãƒ§ãƒ–
    â”‚   â”œâ”€â”€ eval_worker.py       # è©•ä¾¡ã‚¸ãƒ§ãƒ–
    â”‚   â””â”€â”€ audio_engine.py      # Python ç‰ˆ StreamingEngine
    â”œâ”€â”€ widgets/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ log_viewer.py        # ãƒ­ã‚°è¡¨ç¤º (QPlainTextEdit ãƒ™ãƒ¼ã‚¹, auto-scroll)
    â”‚   â”œâ”€â”€ metric_plot.py       # pyqtgraph ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ­ãƒƒãƒˆ
    â”‚   â”œâ”€â”€ audio_meter.py       # ãƒ¬ãƒ™ãƒ«ãƒ¡ãƒ¼ã‚¿ãƒ¼ (å…¥å‡ºåŠ›)
    â”‚   â”œâ”€â”€ file_drop.py         # ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã‚¨ãƒªã‚¢
    â”‚   â”œâ”€â”€ progress_panel.py    # é€²æ—ãƒãƒ¼ + ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
    â”‚   â””â”€â”€ waveform_view.py     # æ³¢å½¢è¡¨ç¤º (pyqtgraph)
    â”œâ”€â”€ models/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ project_state.py     # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçŠ¶æ…‹ç®¡ç†
    â”‚   â””â”€â”€ config_manager.py    # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿æ›¸ã
    â””â”€â”€ resources/
        â””â”€â”€ style.qss            # Qt ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆ
```

---

## 10. æ®µéšçš„å®Ÿè£…è¨ˆç”»

### Phase A: éª¨æ ¼ + ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¢ (æœ€å„ªå…ˆ)

1. ã‚¢ãƒ—ãƒªéª¨æ ¼: MainWindow, ã‚µã‚¤ãƒ‰ãƒãƒ¼, 7 ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
2. AudioEngine: Ring Buffer + ONNX Runtime per-frame æ¨è«–
3. Realtime Demo ãƒšãƒ¼ã‚¸: ãƒã‚¤ã‚¯â†’VCâ†’ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼
4. Speaker Enrollment ãƒšãƒ¼ã‚¸: .tmrvc_speaker ç”Ÿæˆ
5. å…±é€šã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ: LogViewer, AudioMeter, WaveformView

### Phase B: å­¦ç¿’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

6. BaseWorker + TrainWorker
7. Teacher Training ãƒšãƒ¼ã‚¸: å­¦ç¿’å®Ÿè¡Œ + ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ­ãƒƒãƒˆ
8. Distillation ãƒšãƒ¼ã‚¸: è’¸ç•™å®Ÿè¡Œ + A/B æ¯”è¼ƒ

### Phase C: ãƒ‡ãƒ¼ã‚¿ + è©•ä¾¡

9. DataWorker + Data Prep ãƒšãƒ¼ã‚¸
10. EvalWorker + Evaluation ãƒšãƒ¼ã‚¸: å®¢è¦³æŒ‡æ¨™ + A/B ãƒ†ã‚¹ãƒˆ

### Phase D: ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ + ä»•ä¸Šã’

11. ExportWorker + ONNX Export ãƒšãƒ¼ã‚¸
12. SSH ãƒªãƒ¢ãƒ¼ãƒˆå­¦ç¿’çµ±åˆ
13. è¨­å®šæ°¸ç¶šåŒ–ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ”¹å–„

---

## 11. æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] AudioEngine ã¯ `onnx-contract.md` ã® 5 ãƒ¢ãƒ‡ãƒ« I/O ä»•æ§˜ã«æº–æ‹ 
  - content_encoder: mel[1,80,1] + f0[1,1,1] + state[1,256,28] â†’ content[1,256,1] + state_out
  - ir_estimator: mel_chunk[1,80,10] + state[1,128,6] â†’ ir_params[1,24] + state_out
  - converter: content + spk_embed + ir_params + state[1,384,24] â†’ pred_features[1,513,1] + state_out
  - vocoder: features[1,513,1] + state[1,513,14] â†’ stft_mag + stft_phase + state_out
- [ ] State tensor ping-pong ã¯ `cpp-engine-design.md` ã¨åŒæ–¹å¼
- [ ] å­¦ç¿’ Phase æ§‹æˆã¯ `training-plan.md` ã«æº–æ‹  (Phase 0-3)
- [ ] è©•ä¾¡ç›®æ¨™ (SECS >= 0.88, UTMOS >= 3.8) ã¯ `training-plan.md` ã¨ä¸€è‡´
- [ ] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ (hop=240, SR=24000) ã¯ `streaming-design.md` ã¨ä¸€è‡´
- [ ] .tmrvc_speaker ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ (Magic "TMSP" + spk_embed[192] + lora_delta) ã¯ `onnx-contract.md` Â§6 ã«æº–æ‹ 
- [ ] æ¨è«–ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·è¦‹ç©ã‚‚ã‚Š (~27ms) ã¯ 50ms ä»¥ä¸‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’é”æˆ

---

## 12. Latency-Quality Spectrum UI

### 12.1 Realtime Demo è¿½åŠ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«

Realtime Demo ã« `Latency-Quality` ãƒãƒ– (ã¾ãŸã¯ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼) ã‚’è¿½åŠ ã™ã‚‹ã€‚

- å·¦ç«¯: `Live` (æœ€å°ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·)
- å³ç«¯: `Quality` (ã‚¤ãƒ³ãƒˆãƒãƒ¼ã‚·ãƒ§ãƒ³/æ´»èˆŒå„ªå…ˆ)
- å€¤: `q in [0.0, 1.0]`

è¡¨ç¤ºé …ç›®:

- `q` ã®ç¾åœ¨å€¤
- `lookahead_hops` ã¨ `lookahead_ms`
- æ¨å®š/å ±å‘Šãƒ¬ã‚¤ãƒ†ãƒ³ã‚· (`20 + lookahead_hops * 10` ms)
- ç¾åœ¨ã®ãƒ¢ãƒ‡ãƒ«ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ« (`live` / `hq`)

### 12.2 UIä»•æ§˜

| UI | Type | Behavior |
|---|---|---|
| Latency-Quality | Slider (0-100) | å¤‰æ›´æ™‚ã« `q` ã‚’ AudioEngine ã¸é€ä¿¡ |
| Adaptive | Toggle | éè² è·æ™‚ã« `q` è‡ªå‹•é™æ ¼ã‚’æœ‰åŠ¹åŒ– |
| Mode Label | Badge | `LIVE` / `MIX` / `QUALITY` ã‚’è¡¨ç¤º |
| Transition Meter | Small progress bar | ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«åˆ‡æ›¿ã‚¯ãƒ­ã‚¹ãƒ•ã‚§ãƒ¼ãƒ‰é€²è¡Œç‡ |

ãƒ¢ãƒ¼ãƒ‰åˆ†é¡:

- `LIVE`: `0.0 <= q < 0.2`
- `MIX`: `0.2 <= q < 0.8`
- `QUALITY`: `0.8 <= q <= 1.0`

### 12.3 AudioEngine API æ‹¡å¼µ

`workers/audio_engine.py` ã® API ã«ä»¥ä¸‹ã‚’è¿½åŠ ã™ã‚‹ã€‚

```python
class AudioEngine(QThread):
    def set_latency_quality(self, q: float): ...
    def set_adaptive_quality(self, enabled: bool): ...
    def get_latency_quality_state(self) -> dict: ...
```

`get_latency_quality_state()` ã®è¿”å´ä¾‹:

```python
{
    "q": 0.55,
    "lookahead_hops": 3,
    "lookahead_ms": 30,
    "reported_latency_ms": 50,
    "profile": "mix",
    "is_transitioning": False,
}
```

### 12.4 æ“ä½œæ™‚ã®éŸ³åˆ‡ã‚Œé˜²æ­¢

ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼å¤‰æ›´æ™‚ã¯å³æ™‚ãƒãƒ¼ãƒ‰åˆ‡æ›¿ã›ãšã€AudioEngine å´ã§ 100ms ã‚¯ãƒ­ã‚¹ãƒ•ã‚§ãƒ¼ãƒ‰ã‚’å®Ÿæ–½ã™ã‚‹ã€‚
UI ã¯åˆ‡æ›¿ä¸­ãƒ•ãƒ©ã‚°ã‚’å—ã‘å–ã‚Šã€`Transition Meter` ã‚’æ›´æ–°ã™ã‚‹ã€‚

### 12.5 ç›£è¦–ã¨ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯

Adaptive æœ‰åŠ¹æ™‚:

- overrun 3 å›é€£ç¶š -> `q -= 0.2`
- overrun 10 å›é€£ç¶š -> `q = 0.0` + bypass å„ªå…ˆ

GUI å´ã¯è‡ªå‹•å¤‰æ›´ã‚’é€šçŸ¥ã™ã‚‹ (status bar + log)ã€‚